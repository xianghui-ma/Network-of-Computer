# 第 6 章 应用层 #

### 域名与域名系统DNS（Domain Name System） ###

1、域名

一个域名的结构如下：

![p1]

下面是常用顶级域名：

| 国家顶级域名 | 含义 | 通用顶级域名 | 含义 |
|  :----: | :----: |:----: | :----: |
| cn | 中国 | com | 公司企业 |
| us | 美国 | net | 网络服务机构 |
| uk | 英国 | org | 非营利组织 |
| - | - | int | 国际组织 |
| - | - | edu | 教育机构 |
| - | - | gov | 政府部门 |
| - | - | mil | 军事部门 |

我国在顶级域名`cn`下，划分有类别域名和行政区域名两大二级域名。具体如下：

| 类别域名 | 含义 | 行政区域名 | 含义 |
|  :----: | :----: |:----: | :----: |
| ac | 科研机构 | bj | 北京 |
| com | 工、商、金融等企业 | js | 江苏 |
| edu | 中国的教育机构 | - | - |
| gov | 中国的政府组织 | - | - |
| mil | 中国的国防机构 | - | - |
| net | 互联网络服务机构 | - | - |
| org | 非营利组织 | - | - |

2、因特网的域名体系

因特网的域名体系是一个域名树，如下：

![p2]

顶级域名由ICANN直接管理；其他各级域名由上一级的域名管理机构机型管理（如中国从ICANN得到国家顶级域名`cn`，那么`cn`的下一级域名便由`cn`进行管理，`cn`下下级域名便由`cn的下一级`管理）

3、DNS

DNS的作用就是将域名映射为IP地址，因为IP数据报中使用的是IP地址而不是域名

### 域名服务器与域名解析 ###

#### 域名服务器 ####

域名服务器负责将域名解析为IP地址。这儿有四种不同层次的域名服务器：

1、根域名服务器

它是最高层次的域名服务器。其存有顶级域名服务器的域名到IP地址的映射。如果本地域名服务器不能够解析出某个域名的IP，那么会首先求助于根域名服务器

2、顶级域名服务器

其负责管理在该顶级域名服务器注册的所有二级域名

3、权限域名服务器

其是负责一个区域内的域名解析的服务器，用来保存它所负责的区域中的所有主机的域名到IP地址的映射。如下图：

![p3]

abc公司有下属部门x、y。部门x下有u、v、w三个部门。y下有一个部门t。并且公司划分了`abc.com`和`y.abc.com`两个区。这两个取分别对应一个域名服务器（即权限域名服务器）

4、本地域名服务器

本地域名服务器一般指距用户最近的域名服务器。主机发出的DNS请求会首先发给本地域名服务器解析

上述域名服务器的层级关系如下：

![p5]

#### 域名解析流程 ####

有两种解析方式可以实现域名解析。如下：

![p4]

1、迭代查询

迭代查询的方式是这样的：本地域名服务器解析不了就求助根服务器，根服务器告诉本地域名服务器到A域名服务器查；本地域名服务器于是到A查询，但A也解析不了，于是告诉本地域名服务器到B，于是本地域名服务器就到B查询；......就这样直到本地域名服务器得到IP并返回给客户

2、递归查询

递归查询的方式是这样的：本地域名服务器解析不了就求助根服务器，根服务器代替本地域名服务器到A域名服务器查；但A也解析不了，于是A代替根域名服务器到B去查；......就这样直到得到IP并层层返回到本地域名服务器，然后本地域名服务器将IP交给客户

至于究竟使用那种解析方式则自行选择。现选择迭代方式举一个例子：

假设主机m.xyz.com打算发送邮件给主机y.abc.com。这时就必须知道主机y.abc.com的IP地址，解析过程如下，

1. 主机m.xyz.com先向其本地域名服务器dns.xyz.com进行递归查询
2. 本地域名服务器采用迭代查询。它先向一个根域名服务器查询
3. 根域名服务器告诉本地域名服务器，下一次应查询的本地域名服务器dns.com的IP地址
4. 本地域名服务器向顶级域名服务器dns.com进行查询
5. 顶级域名服务器dns.com告诉本地域名服务器，下一次应查询的权限域名服务器dns.abc.com的IP地址
6. 本地域名服务器向权限域名服务器dns.abc.com进行查询
7. 权限域名服务器dns.abc.com告诉本地域名服务器，所查询的主机的IP地址
8. 本地域名服务器最后把查询结果告诉主机m.xyz.com

> 域名服务器中设有DNS高速缓存，用来存放近期查询过的域名，以便下次有人访问时直接返回IP地址，提高效率